<!DOCTYPE html>
<html lang="en">
<head>
 <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Build bicycle tracker using Kotlin (Part 1)</title>
<meta name="description" content="Unknown">
<meta name="keywords" content="Software Engineering, Devops, Cloud">
<meta name="author" content="Unknown">
<meta property="og:title" content="Build bicycle tracker using Kotlin (Part 1)">
<meta property="og:description" content="Unknown">
<meta property="og:type" content="website">
<meta property="og:url" content="https://new.drnd.rocks">
<meta property="og:image" content="https://new.drnd.rocks/image.jpg">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Build bicycle tracker using Kotlin (Part 1)">
<meta name="twitter:description" content="Unknown">
<meta name="twitter:image" content="https://new.drnd.rocks">
<link rel="canonical" href="https://new.drnd.rocks">
<link rel="stylesheet" href="/css/main.css">
 
</head>
<body>
    <header>
    <nav>
        <ul class="menu">
            <li><a href="https://new.drnd.rocks/">Home</a></li>
            
                <li><a href="https://new.drnd.rocks/about">About</a></li>
            
                <li><a href="https://new.drnd.rocks/blog">Blog</a></li>
            
        </ul>
    </nav>
</header></div>

 
    <div class="container">
        <div class="post-meta">
    <span class="publish-date">Published on: February 25, 2024</span>
<!--     <span class="tags">Tags: <a href="#">Cycling</a>, <a href="#">Kotlin</a>, <a href="#">Ktor</a></span> -->
</div>
        <p><h1>Build bicycle tracker using Kotlin (Part 1)</h1>

<p>I love cycling, and I&rsquo;m excited to share that I&rsquo;m gearing up for the <a href="https://berlin-munich-berlin.org/" target="_blank">ultra cycling event from Berlin to Munich and back</a>, happening in August 2024. I&rsquo;ve already started training hard for it.</p>

<p>To keep everyone in the loop and ensure my safety during the race, I&rsquo;m planning to create an app. This app will use my phone as a client to send my location to the server every 5-10 minutes while I&rsquo;m cycling. Then, my friends and family can see where I am on a map through a website on their computers or phones.</p>

<p>The app will be super easy to use. It&rsquo;ll just show a map with a dot indicating where I am at that moment. This way, my loved ones can cheer me on and know I&rsquo;m safe throughout the event.
<!-- more --></p>

<h2>Decision on stack</h2>

<p>I&rsquo;ve chosen to develop server side using <a href="https://ktor.io/" target="_blank">Ktor</a>. Ktor is a framework designed for building both server-side and client-side applications with Kotlin, a modern programming language. It&rsquo;s built on Kotlin coroutines, which are lightweight and efficient for handling concurrent tasks.</p>

<p>To display my location, I&rsquo;ve opted for server-side templating with Freemarker. I&rsquo;ve chosen this approach to keep things simple, avoiding the need to build a full-fledged web application using React, Angular, or Vue.js. Since the goal is to have just one page showing the location on a map, this streamlined approach seems fitting.</p>

<p>For the client side, I&rsquo;m looking into using <a href="https://www.jetbrains.com/lp/compose-multiplatform/" target="_blank">Compose Multiplatform</a>, a modern UI framework written in Kotlin. This will allow me to create a seamless and responsive user interface across different platforms while leveraging the power and flexibility of Kotlin.</p>

<h2>Setup the server side</h2>

<p>To start the Ktor project go to  <a href="https://start.ktor.io" target="_blank">Ktor project generator</a> where you can configure all dependencies needed fo the project. Ktor is designed to be flexible and customizable. Depending on your needs, you can add various plugins to your project as Gradle dependencies. In this case I have decided to use folowing ktor dedendencies which are called</p>

<ul>
<li>io.ktor:ktor-server-core-jvm - it contains core Ktor functionality</li>
<li>io.ktor:ktor-server-netty-jvm -network engine which will process requests. In this case it is Netty.</li>
<li>io.ktor:ktor-server-content-negotiation-jvm - <a href="https://ktor.io/docs/serialization-client.html" target="_blank">plugin</a> for negotiation media types between the client and server and serializing/deserializing the content in a specific format</li>
<li>io.ktor:ktor-serialization-kotlinx-json - plugin for serializing/deserializing JSON data</li>
<li>io.ktor:ktor-server-freemarker-jvm - <a href="https://ktor.io/docs/freemarker.html" target="_blank">plugin</a> to use Freemarker templating</li>
<li>io.ktor:ktor-server-default-headers-jvm - standard plugin which adds the standard Server and Date headers into each response.</li>
</ul>

<p>The project generated by the Ktor project generator comes with a basic project structure. I&rsquo;ve opted to use Gradle as the build tool, configured with Kotlin. The generated project includes Gradle&rsquo;s wrapper, so there&rsquo;s no need to install Gradle separately on your machine. The only requirement is to have Java installed.</p>

<p>Files Application.kt and Routing.kt contains minimal code to run the application and to configure simple routing for get request. Exposing simple GET endpoint look like:</p>

<p>&rdquo;`kotlin
fun Application.configureRouting() {</p>

<pre><code>routing {
    get(&quot;/&quot;) {
        call.respondText(&quot;Hello World!&quot;)
    }

}
</code></pre>

<p>}
&ldquo;`</p>

<h3>Configure dependency injection</h3>

<p>Dependency injection is a widely used pattern in the Java ecosystem, as well as in object-oriented languages in general. It promotes loose coupling by separating object construction from their usage. While the Spring framework is the go-to choice for dependency injection in Java and it can be used in Kotlin, for smaller applications, it might be overkill. That&rsquo;s why I&rsquo;ve opted to use Koin, a lightweight dependency injection framework written in Kotlin, which offers simplicity and efficiency for smaller projects.</p>

<p>Add depdency <em>io.insert-koin:koin-ktor</em>, Ktor plugin for Koin depdency injection inside Gradle build file <em>build.gradle.kts</em>. Add <em>Koin.kt</em> file to install Koin plugin.</p>

<p>&rdquo;`kotlin
fun Application.configureKoin() {</p>

<pre><code>install(Koin) {

}
</code></pre>

<p>}
&ldquo;`</p>

<h2>Running Ktor application</h2>

<p>The project generated by the Ktor project generator comes pre-configured with Gradle tasks for building and running the Ktor application. You can view all available tasks by running the command:</p>

<p><code>bash
./gradlew tasks
</code></p>

<p>To run the application via Gradle, execute the following Gradle task:
<code>bash
./gradlew runFatJar
</code></p>

<p>To build fat jar, execute the following Gradle task:</p>

<p><code>bash
./gradlew buildFatJar
</code><br />
The executable jar is located under directory * build/libs/* with suffix <em>all</em>.</p>

<h2>Conclusion</h2>

<p>I&rsquo;ve outlined the initial steps to bootstrap a Ktor application in this post, which shouldn&rsquo;t take more than 15 minutes to set up. You can see all code on <a href="https://github.com/drndivoje/whereisivan"> my github account</a>. Changes described in this post you can see <a href="https://github.com/drndivoje/whereisivan/commit/e12dcb1c0ae6501875f566c0168d0b18f62d281a">here</a>.</p>

<p>Given my professional background mostly in backend development, this part is relatively straightforward for me. However, the real challenge lies in building the mobile client using the Compose Multiplatform framework. But hey, challenges are what keep life exciting, right? And speaking of excitement, let&rsquo;s not forget about keeping track of my cycling training progress â€“ that&rsquo;s a whole other journey on its own! Stay tuned for my next post!</p>
</p>
    </main>
    <footer>
    <p>&copy; 2025 Ivan Doskovic</p>
    
</footer>
</body>
</html>